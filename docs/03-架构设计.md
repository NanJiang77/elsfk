# ä¿„ç½—æ–¯æ–¹å—æ¸¸æˆ - æ¶æ„è®¾è®¡æ–‡æ¡£

## ğŸ“Œ æ¶æ„æ¦‚è¿°

æœ¬æ–‡æ¡£æè¿°ä¿„ç½—æ–¯æ–¹å—æ¸¸æˆçš„ç³»ç»Ÿæ¶æ„ã€æŠ€æœ¯é€‰å‹ã€æ¨¡å—è®¾è®¡å’Œæ•°æ®æµè½¬ã€‚

**æ¶æ„é£æ ¼**: å‰åç«¯åˆ†ç¦»æ¶æ„
**å¼€å‘æ¨¡å¼**: æ¨¡å—åŒ–å¼€å‘

---

## ğŸ—ï¸ æ•´ä½“æ¶æ„è®¾è®¡

### ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       ç”¨æˆ·å±‚                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              Web æµè§ˆå™¨ (Chrome/Edge/Firefox)    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†• HTTP/HTTPS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å‰ç«¯åº”ç”¨å±‚ (Vue 3)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  è§†å›¾å±‚ (View Layer)                             â”‚   â”‚
â”‚  â”‚  - GameCanvas (Canvas æ¸²æŸ“)                      â”‚   â”‚
â”‚  â”‚  - ControlsPanel (æ“ä½œè¯´æ˜)                      â”‚   â”‚
â”‚  â”‚  - InfoPanel (æ¸¸æˆä¿¡æ¯)                          â”‚   â”‚
â”‚  â”‚  - Overlay (è¦†ç›–å±‚)                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â†•                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ä¸šåŠ¡é€»è¾‘å±‚ (Business Logic Layer)               â”‚   â”‚
â”‚  â”‚  - GameEngine (æ¸¸æˆå¼•æ“)                         â”‚   â”‚
â”‚  â”‚  - PieceManager (æ–¹å—ç®¡ç†,7-Bagç³»ç»Ÿ)            â”‚   â”‚
â”‚  â”‚  - CollisionDetector (ç¢°æ’æ£€æµ‹)                  â”‚   â”‚
â”‚  â”‚  - LineClearManager (è¡Œæ¶ˆé™¤)                     â”‚   â”‚
â”‚  â”‚  - ScoreManager (åˆ†æ•°ç®¡ç†)                       â”‚   â”‚
â”‚  â”‚  - LevelManager (ç­‰çº§ç®¡ç†)                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â†•                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  çŠ¶æ€ç®¡ç†å±‚ (State Management Layer)             â”‚   â”‚
â”‚  â”‚  - Pinia Store                                  â”‚   â”‚
â”‚  â”‚    â”œâ”€ gameStore (æ¸¸æˆçŠ¶æ€)                      â”‚   â”‚
â”‚  â”‚    â”œâ”€ scoreStore (åˆ†æ•°çŠ¶æ€)                      â”‚   â”‚
â”‚  â”‚    â””â”€ uiStore (UIçŠ¶æ€)                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†• RESTful API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   åç«¯æœåŠ¡å±‚ (FastAPI)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  API è·¯ç”±å±‚                                      â”‚   â”‚
â”‚  â”‚  - /api/games/ (æ¸¸æˆè®°å½•å’Œæ’è¡Œæ¦œ)                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â†•                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ä¸šåŠ¡é€»è¾‘å±‚                                      â”‚   â”‚
â”‚  â”‚  - GameService (æ¸¸æˆä¸šåŠ¡)                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â†•                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  æ•°æ®è®¿é—®å±‚ (DAL)                                â”‚   â”‚
â”‚  â”‚  - Database (SQLite)                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   æ•°æ®å­˜å‚¨å±‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  SQLite æ•°æ®åº“                                   â”‚   â”‚
â”‚  â”‚  - games (æ¸¸æˆè®°å½•è¡¨)                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  æµè§ˆå™¨å­˜å‚¨                                      â”‚   â”‚
â”‚  â”‚  - localStorage (æœ€é«˜åˆ†ã€æ¸¸æˆè®¾ç½®)               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ å‰ç«¯æ¶æ„è®¾è®¡

### 1. å‰ç«¯æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Vue 3 | 3.4+ | å‰ç«¯æ¡†æ¶ |
| TypeScript | 5.0+ | ç±»å‹ç³»ç»Ÿ |
| Vite | 5.0+ | æ„å»ºå·¥å…· |
| Pinia | 2.1+ | çŠ¶æ€ç®¡ç† |
| Vue Router | 4.2+ | è·¯ç”±ç®¡ç† |
| Element Plus | 2.4+ | UI ç»„ä»¶åº“ (ä»…ç”¨äºå¯¼èˆªæ å’Œæ’è¡Œæ¦œè¡¨æ ¼) |
| Canvas API | - | æ¸¸æˆç”»é¢æ¸²æŸ“ |

**è¯´æ˜**: Element Plus ä»…ç”¨äºéæ¸¸æˆæ ¸å¿ƒåŒºåŸŸï¼ˆå¯¼èˆªæ ã€æ’è¡Œæ¦œè¡¨æ ¼ï¼‰ï¼Œæ¸¸æˆåŒºåŸŸå®Œå…¨è‡ªå®šä¹‰ã€‚

---

### 2. å‰ç«¯ç›®å½•ç»“æ„

```
elsfk/
â”œâ”€â”€ frontend/                        # å‰ç«¯é¡¹ç›®æ ¹ç›®å½•
â”‚   â”œâ”€â”€ public/                      # é™æ€èµ„æº
â”‚   â”‚   â””â”€â”€ favicon.ico
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ assets/                  # èµ„æºæ–‡ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ images/
â”‚   â”‚   â”‚   â”œâ”€â”€ sounds/              # éŸ³æ•ˆæ–‡ä»¶ â­ æ–°å¢
â”‚   â”‚   â”‚   â””â”€â”€ styles/
â”‚   â”‚   â”‚       â”œâ”€â”€ global.css       # å…¨å±€æ ·å¼
â”‚   â”‚   â”‚       â”œâ”€â”€ variables.css    # CSS å˜é‡
â”‚   â”‚   â”‚       â””â”€â”€ reset.css        # æ ·å¼é‡ç½®
â”‚   â”‚   â”œâ”€â”€ components/              # ç»„ä»¶ç›®å½•
â”‚   â”‚   â”‚   â”œâ”€â”€ layout/              # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Header.vue       # é¡¶éƒ¨å¯¼èˆªæ 
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Footer.vue       # åº•éƒ¨é¡µè„š
â”‚   â”‚   â”‚   â”œâ”€â”€ game/                # æ¸¸æˆç»„ä»¶
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ GameCanvas.vue   # æ¸¸æˆç”»å¸ƒ
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Overlay.vue      # æ¸¸æˆè¦†ç›–å±‚
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ControlsPanel.vue # å·¦ä¾§æ“ä½œè¯´æ˜
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ InfoPanel.vue    # å³ä¾§ä¿¡æ¯é¢æ¿
â”‚   â”‚   â”‚   â””â”€â”€ common/              # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”‚       â”œâ”€â”€ NextPiece.vue    # ä¸‹ä¸€æ–¹å—é¢„è§ˆ
â”‚   â”‚   â”‚       â”œâ”€â”€ ScoreDisplay.vue # åˆ†æ•°æ˜¾ç¤º
â”‚   â”‚   â”‚       â””â”€â”€ KeyCard.vue      # æŒ‰é”®å¡ç‰‡
â”‚   â”‚   â”œâ”€â”€ views/                   # é¡µé¢è§†å›¾
â”‚   â”‚   â”‚   â”œâ”€â”€ GamePage.vue         # æ¸¸æˆä¸»é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ LeaderBoardPage.vue  # æ’è¡Œæ¦œé¡µé¢
â”‚   â”‚   â”‚   â””â”€â”€ SettingsPage.vue     # è®¾ç½®é¡µé¢
â”‚   â”‚   â”œâ”€â”€ stores/                  # Pinia çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ game.ts              # æ¸¸æˆçŠ¶æ€ store
â”‚   â”‚   â”‚   â”œâ”€â”€ score.ts             # åˆ†æ•°çŠ¶æ€ store
â”‚   â”‚   â”‚   â””â”€â”€ ui.ts                # UI çŠ¶æ€ store
â”‚   â”‚   â”œâ”€â”€ services/                # æœåŠ¡å±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ game/                # æ¸¸æˆæ ¸å¿ƒé€»è¾‘
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ GameEngine.ts    # æ¸¸æˆå¼•æ“
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ PieceManager.ts  # æ–¹å—ç®¡ç†å™¨ (å«7-Bag)
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ CollisionDetector.ts # ç¢°æ’æ£€æµ‹
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ LineClearManager.ts # è¡Œæ¶ˆé™¤ç®¡ç†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ScoreManager.ts  # åˆ†æ•°ç®¡ç†å™¨
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ LevelManager.ts  # ç­‰çº§ç®¡ç†å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ audio/               # éŸ³æ•ˆæœåŠ¡ â­ æ–°å¢
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ SoundManager.ts  # éŸ³æ•ˆç®¡ç†å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ api/                 # API æœåŠ¡
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ gameApi.ts       # æ¸¸æˆ API (å«é‡è¯•)
â”‚   â”‚   â”‚   â””â”€â”€ storage/             # æœ¬åœ°å­˜å‚¨æœåŠ¡
â”‚   â”‚   â”‚       â””â”€â”€ localStorage.ts  # localStorage å°è£…
â”‚   â”‚   â”œâ”€â”€ types/                   # TypeScript ç±»å‹å®šä¹‰
â”‚   â”‚   â”‚   â”œâ”€â”€ game.ts              # æ¸¸æˆç›¸å…³ç±»å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ piece.ts             # æ–¹å—ç›¸å…³ç±»å‹ (å«å®Œæ•´æ—‹è½¬)
â”‚   â”‚   â”‚   â”œâ”€â”€ api.ts               # API ç›¸å…³ç±»å‹
â”‚   â”‚   â”‚   â””â”€â”€ error.ts             # é”™è¯¯ç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ utils/                   # å·¥å…·å‡½æ•°
â”‚   â”‚   â”‚   â”œâ”€â”€ canvas.ts            # Canvas å·¥å…· (å«ç¦»å±æ¸²æŸ“)
â”‚   â”‚   â”‚   â”œâ”€â”€ animation.ts         # åŠ¨ç”»å·¥å…·
â”‚   â”‚   â”‚   â”œâ”€â”€ validator.ts         # éªŒè¯å·¥å…·
â”‚   â”‚   â”‚   â””â”€â”€ errorHandler.ts      # é”™è¯¯å¤„ç†å·¥å…·
â”‚   â”‚   â”œâ”€â”€ config/                  # é…ç½®æ–‡ä»¶ â­ æ–°å¢
â”‚   â”‚   â”‚   â””â”€â”€ gameConfig.ts        # æ¸¸æˆé…ç½®å¸¸é‡
â”‚   â”‚   â”œâ”€â”€ router/                  # è·¯ç”±é…ç½®
â”‚   â”‚   â”‚   â””â”€â”€ index.ts             # è·¯ç”±å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ App.vue                  # æ ¹ç»„ä»¶
â”‚   â”‚   â””â”€â”€ main.ts                  # å…¥å£æ–‡ä»¶
â”‚   â”œâ”€â”€ index.html                   # HTML æ¨¡æ¿
â”‚   â”œâ”€â”€ vite.config.ts               # Vite é…ç½®
â”‚   â”œâ”€â”€ tsconfig.json                # TypeScript é…ç½®
â”‚   â””â”€â”€ package.json                 # ä¾èµ–é…ç½®
```

---

### 3. å‰ç«¯æ ¸å¿ƒæ¨¡å—è®¾è®¡

#### 3.1 æ¸¸æˆå¼•æ“ (GameEngine)

**èŒè´£**: æ¸¸æˆä¸»å¾ªç¯ã€çŠ¶æ€æ§åˆ¶ã€äº‹ä»¶è°ƒåº¦

```typescript
class GameEngine {
  // æ¸¸æˆçŠ¶æ€
  private state: GameState
  private gameLoopId: number | null
  private lastTime: number
  private startTime: number            // æ¸¸æˆå¼€å§‹æ—¶é—´
  private dropTimer: number = 0        // ä¸‹è½è®¡æ—¶å™¨
  private dropInterval: number         // ä¸‹è½é—´éš”(ms)

  // æš‚åœè®¡æ—¶ â­ æ–°å¢
  private pauseStartTime: number | null = null
  private totalPausedTime: number = 0

  // è‡ªåŠ¨ä¿å­˜ â­ æ–°å¢
  private autoSaveInterval: number | null = null

  // æ ¸å¿ƒç»„ä»¶
  private pieceManager: PieceManager
  private collisionDetector: CollisionDetector
  private lineClearManager: LineClearManager
  private scoreManager: ScoreManager
  private levelManager: LevelManager

  // ç”Ÿå‘½å‘¨æœŸæ–¹æ³•
  start(): void
  pause(): void
  resume(): void
  reset(): void

  // æ¸¸æˆå¾ªç¯ (ä½¿ç”¨ requestAnimationFrame)
  private gameLoop(timestamp: number): void
  private update(deltaTime: number): void
  private render(): void

  // äº‹ä»¶å¤„ç†
  handleInput(key: string): void

  // æ ¸å¿ƒæ¸¸æˆæµç¨‹
  private lockPiece(): void              // é”å®šæ–¹å—åˆ°æ£‹ç›˜
  private clearLines(): void             // æ¶ˆé™¤å®Œæ•´è¡Œ
  private spawnNewPiece(): void          // ç”Ÿæˆæ–°æ–¹å—
  private checkGameOver(): void          // æ£€æŸ¥æ¸¸æˆç»“æŸ â­ å®Œå–„

  // æš‚åœè®¡æ—¶ â­ æ–°å¢
  private getActualPlayTime(): number

  // æ•°æ®æŒä¹…åŒ– â­ æ–°å¢
  private startAutoSave(): void
  private saveGameRecord(): void
  private saveGameProgress(): void
}
```

**æ¸¸æˆå¾ªç¯è¯¦ç»†å®ç°**:
```typescript
private update(deltaTime: number): void {
  // 1. ç´¯åŠ ä¸‹è½è®¡æ—¶å™¨
  this.dropTimer += deltaTime

  // 2. æ£€æŸ¥æ˜¯å¦éœ€è¦è‡ªåŠ¨ä¸‹è½
  if (this.dropTimer >= this.dropInterval) {
    this.dropTimer = 0
    const newPiece = this.pieceManager.moveDown(this.currentPiece, this.board)

    if (newPiece) {
      // å¯ä»¥ç»§ç»­ä¸‹è½
      this.currentPiece = newPiece
    } else {
      // æ–¹å—è½åœ°ï¼Œæ‰§è¡Œä»¥ä¸‹æµç¨‹ï¼š
      this.lockPiece()          // 1. é”å®šæ–¹å—åˆ°æ£‹ç›˜
      const clearedLines = this.clearLines()  // 2. æ£€æŸ¥å¹¶æ¶ˆé™¤è¡Œ
      this.spawnNewPiece()      // 3. ç”Ÿæˆæ–°æ–¹å—
      this.checkGameOver()      // 4. æ£€æŸ¥æ¸¸æˆç»“æŸ

      // 5. æ›´æ–°åˆ†æ•°å’Œç­‰çº§
      if (clearedLines > 0) {
        this.scoreManager.addScore(clearedLines)
        this.scoreManager.addLines(clearedLines)
        const newLevel = this.levelManager.getLevel(this.scoreManager.getTotalLines())
        this.dropInterval = this.levelManager.calculateDropInterval(newLevel)
      }
    }
  }
}
```

**æ¸¸æˆç»“æŸåˆ¤å®š** â­ å®Œå–„:
```typescript
private checkGameOver(): void {
  // åˆ¤å®šæ¡ä»¶: æ–°ç”Ÿæˆçš„æ–¹å—åœ¨åˆå§‹ä½ç½®å°±å‘ç”Ÿç¢°æ’
  if (this.collisionDetector.checkCollision(this.currentPiece, this.board, this.currentPiece.position)) {
    this.state = GameState.GAMEOVER

    // 1. åœæ­¢æ¸¸æˆå¾ªç¯
    this.stopGameLoop()

    // 2. ä¿å­˜æ¸¸æˆè®°å½•åˆ°åç«¯
    this.saveGameRecord()

    // 3. æ˜¾ç¤ºæ¸¸æˆç»“æŸç•Œé¢
    this.uiStore.showGameOverOverlay()
  }
}
```

**æš‚åœè®¡æ—¶æœºåˆ¶** â­ æ–°å¢:
```typescript
pause(): void {
  if (this.state === GameState.PLAYING) {
    this.state = GameState.PAUSED
    this.pauseStartTime = Date.now()
  }
}

resume(): void {
  if (this.state === GameState.PAUSED) {
    this.state = GameState.PLAYING
    if (this.pauseStartTime) {
      this.totalPausedTime += Date.now() - this.pauseStartTime
      this.pauseStartTime = null
    }
    this.lastTime = performance.now()
    this.gameLoopId = requestAnimationFrame(this.gameLoop.bind(this))
  }
}

private getActualPlayTime(): number {
  // å®é™…æ¸¸æˆæ—¶é•¿ = å½“å‰æ—¶é—´ - å¼€å§‹æ—¶é—´ - æ€»æš‚åœæ—¶é—´
  const totalTime = Date.now() - this.startTime
  return Math.floor((totalTime - this.totalPausedTime) / 1000)
}
```

**æ•°æ®æŒä¹…åŒ–** â­ æ–°å¢:
```typescript
private startAutoSave(): void {
  // æ¯30ç§’è‡ªåŠ¨ä¿å­˜æ¸¸æˆè¿›åº¦
  this.autoSaveInterval = setInterval(() => {
    this.saveGameProgress()
  }, 30000)
}

private saveGameRecord(): void {
  // æ¸¸æˆç»“æŸæ—¶ä¿å­˜å®Œæ•´è®°å½•
  const record = {
    player_name: "Player",
    score: this.scoreManager.getScore(),
    level: this.levelManager.getLevel(this.scoreManager.getTotalLines()),
    lines: this.scoreManager.getTotalLines(),
    play_time: this.getActualPlayTime()
  }

  // è°ƒç”¨ API (å¸¦é‡è¯•æœºåˆ¶)
  gameApi.saveGame(record)
}

private saveGameProgress(): void {
  // ä¿å­˜å½“å‰æ¸¸æˆè¿›åº¦åˆ° localStorage
  const progress = {
    board: this.board,
    currentPiece: this.currentPiece,
    nextPiece: this.nextPiece,
    score: this.scoreManager.getScore(),
    level: this.levelManager.getLevel(this.scoreManager.getTotalLines()),
    lines: this.scoreManager.getTotalLines()
  }

  localStorage.setItem('game_progress', JSON.stringify(progress))
}
```

**çŠ¶æ€æšä¸¾**:
```typescript
enum GameState {
  IDLE = 'idle',           // æœªå¼€å§‹
  PLAYING = 'playing',     // æ¸¸æˆä¸­
  PAUSED = 'paused',       // æš‚åœ
  GAMEOVER = 'gameover'    // æ¸¸æˆç»“æŸ
}
```

---

#### 3.2 æ–¹å—ç®¡ç†å™¨ (PieceManager) â­ å®Œå–„

**èŒè´£**: æ–¹å—ç”Ÿæˆã€æ—‹è½¬ã€ç§»åŠ¨ã€7-Bagéšæœºç³»ç»Ÿ

```typescript
class PieceManager {
  // å½“å‰æ–¹å—å’Œä¸‹ä¸€ä¸ªæ–¹å—
  private currentPiece: Piece
  private nextPiece: Piece

  // 7-Bag éšæœºç³»ç»Ÿ â­ æ–°å¢
  private bag: PieceType[] = []
  private readonly PIECE_TYPES: PieceType[] = ['I', 'O', 'T', 'S', 'Z', 'J', 'L']

  // æ–¹å—ç”Ÿæˆ (ä½¿ç”¨7-Bagç³»ç»Ÿ) â­ å®Œå–„
  generatePiece(): Piece {
    const type = this.getNextPieceType()
    return {
      type,
      shape: PIECE_SHAPES[type],
      color: PIECE_COLORS[type],
      position: { x: 3, y: 0 },  // åˆå§‹ä½ç½®
      rotation: 0
    }
  }

  // 7-Bag éšæœºç®—æ³• â­ æ–°å¢
  private getNextPieceType(): PieceType {
    if (this.bag.length === 0) {
      // ç”ŸæˆåŒ…å«æ‰€æœ‰7ç§æ–¹å—çš„è¢‹å­å¹¶æ‰“ä¹±
      this.bag = [...this.PIECE_TYPES].sort(() => Math.random() - 0.5)
    }
    return this.bag.pop()!
  }

  // æ–¹å—æ“ä½œ
  moveLeft(piece: Piece, board: Board): Piece | null
  moveRight(piece: Piece, board: Board): Piece | null
  moveDown(piece: Piece, board: Board): Piece | null
  rotate(piece: Piece, board: Board): Piece | null
  hardDrop(piece: Piece, board: Board): Position
}
```

**7-Bag éšæœºç³»ç»Ÿè¯´æ˜** â­ æ–°å¢:
- æ¯7ä¸ªæ–¹å—å¿…å®šåŒ…å«æ‰€æœ‰7ç§ç±»å‹
- ä¿è¯æ¸¸æˆå…¬å¹³æ€§,é¿å…è¿ç»­å‡ºç°ç›¸åŒæ–¹å—
- æ›´æ¥è¿‘åŸç‰ˆä¿„ç½—æ–¯æ–¹å—ä½“éªŒ

---

#### 3.3 ç¢°æ’æ£€æµ‹å™¨ (CollisionDetector)

**èŒè´£**: æ£€æµ‹æ–¹å—ç¢°æ’ã€è¾¹ç•Œæ£€æµ‹

```typescript
class CollisionDetector {
  // ç¢°æ’æ£€æµ‹
  checkCollision(piece: Piece, board: Board, newPos: Position): boolean
  checkBoundary(piece: Piece, board: Board): boolean
  checkRotationCollision(piece: Piece, newShape: number[][], board: Board): boolean

  // è¾…åŠ©æ–¹æ³•
  isValidPosition(pos: Position, board: Board): boolean
  isOccupied(pos: Position, board: Board): boolean
}
```

**æ£‹ç›˜æ•°æ®ç»“æ„**:
```typescript
interface Board {
  width: number           // 10
  height: number          // 20
  grid: Cell[][]          // 20Ã—10 çš„ç½‘æ ¼
}

interface Cell {
  occupied: boolean       // æ˜¯å¦è¢«å ç”¨
  color: string | null    // æ–¹å—é¢œè‰²
}
```

---

#### 3.4 è¡Œæ¶ˆé™¤ç®¡ç†å™¨ (LineClearManager)

**èŒè´£**: æ£€æµ‹å®Œæ•´è¡Œã€æ¶ˆé™¤è¡Œã€ä¸‹ç§»æ–¹å—

```typescript
class LineClearManager {
  // æ£€æŸ¥å®Œæ•´çš„è¡Œ
  findFullLines(board: Board): number[]

  // æ¶ˆé™¤è¡Œå¹¶è¿”å›æ¶ˆé™¤çš„è¡Œæ•°
  clearLines(board: Board, lines: number[]): number

  // æ¶ˆé™¤åä¸‹ç§»ä¸Šæ–¹æ–¹å—
  dropLinesAbove(board: Board, clearedLines: number[]): void

  // æ£€æŸ¥å•è¡Œæ˜¯å¦å®Œæ•´
  isLineFull(board: Board, lineIndex: number): boolean
}
```

**å®ç°é€»è¾‘**:
```typescript
clearLines(board: Board, lines: number[]): number {
  // 1. ä»ä¸‹å¾€ä¸Šæ¶ˆé™¤è¡Œ
  lines.sort((a, b) => b - a)

  for (const lineIndex of lines) {
    // 2. ç§»é™¤è¯¥è¡Œ
    board.grid.splice(lineIndex, 1)

    // 3. åœ¨é¡¶éƒ¨æ·»åŠ æ–°çš„ç©ºè¡Œ
    board.grid.unshift(Array(board.width).fill(null).map(() => ({
      occupied: false,
      color: null
    })))
  }

  return lines.length
}
```

---

#### 3.5 åˆ†æ•°ç®¡ç†å™¨ (ScoreManager)

**èŒè´£**: åˆ†æ•°è®¡ç®—ã€è¡Œæ¶ˆé™¤ç»Ÿè®¡

```typescript
class ScoreManager {
  // åˆ†æ•°è§„åˆ™ (ä»é…ç½®è¯»å–) â­ æ”¹è¿›
  private readonly SCORE_RULES = GAME_CONFIG.SCORE

  // åˆ†æ•°ç®¡ç†
  calculateScore(linesCleared: number): number
  addScore(score: number): void
  getScore(): number
  resetScore(): void

  // è¡Œæ¶ˆé™¤ç»Ÿè®¡
  getTotalLines(): number
  addLines(lines: number): void
}
```

---

#### 3.6 ç­‰çº§ç®¡ç†å™¨ (LevelManager)

**èŒè´£**: ç­‰çº§è®¡ç®—ã€é€Ÿåº¦æ§åˆ¶

```typescript
class LevelManager {
  // ç­‰çº§è§„åˆ™ (ä»é…ç½®è¯»å–) â­ æ”¹è¿›
  private readonly LINES_PER_LEVEL = GAME_CONFIG.LEVEL.LINES_PER_LEVEL

  // ç­‰çº§ç®¡ç†
  getLevel(totalLines: number): number
  calculateDropInterval(level: number): number

  // é€Ÿåº¦è®¡ç®— (éçº¿æ€§é€’å‡)
  // ä¸‹è½é—´éš”(ms) = 1000 / (1 + (ç­‰çº§-1) Ã— 0.1)
  private calculateSpeed(level: number): number
}
```

---

#### 3.7 éŸ³æ•ˆç®¡ç†å™¨ (SoundManager) â­ æ–°å¢

**èŒè´£**: ç®¡ç†æ¸¸æˆéŸ³æ•ˆæ’­æ”¾

```typescript
// services/audio/SoundManager.ts
class SoundManager {
  private sounds: Map<string, HTMLAudioElement>
  private enabled: boolean = true

  constructor() {
    this.sounds = new Map()
    this.loadSounds()
  }

  // åŠ è½½éŸ³æ•ˆæ–‡ä»¶
  private loadSounds(): void {
    this.sounds.set('move', new Audio('/sounds/move.mp3'))
    this.sounds.set('rotate', new Audio('/sounds/rotate.mp3'))
    this.sounds.set('drop', new Audio('/sounds/drop.mp3'))
    this.sounds.set('clear', new Audio('/sounds/clear.mp3'))
    this.sounds.set('levelUp', new Audio('/sounds/levelup.mp3'))
    this.sounds.set('gameOver', new Audio('/sounds/gameover.mp3'))
  }

  // æ’­æ”¾éŸ³æ•ˆ
  playMove(): void      // ç§»åŠ¨éŸ³æ•ˆ
  playRotate(): void    // æ—‹è½¬éŸ³æ•ˆ
  playDrop(): void      // è½åœ°éŸ³æ•ˆ
  playClear(): void     // æ¶ˆé™¤éŸ³æ•ˆ
  playLevelUp(): void   // å‡çº§éŸ³æ•ˆ
  playGameOver(): void  // æ¸¸æˆç»“æŸéŸ³æ•ˆ

  // è®¾ç½®éŸ³æ•ˆå¼€å…³
  setEnabled(enabled: boolean): void {
    this.enabled = enabled
  }
}
```

---

### 4. å‰ç«¯çŠ¶æ€ç®¡ç† (Pinia Store)

#### 4.1 æ¸¸æˆçŠ¶æ€ Store (gameStore)

```typescript
// stores/game.ts
export const useGameStore = defineStore('game', {
  state: () => ({
    gameState: GameState.IDLE,
    board: createEmptyBoard(),
    currentPiece: null,
    nextPiece: null,
    isPaused: false
  }),

  actions: {
    startGame(): void
    pauseGame(): void
    resumeGame(): void
    resetGame(): void
    updateBoard(newBoard: Board): void
    setCurrentPiece(piece: Piece): void
  }
})
```

#### 4.2 åˆ†æ•°çŠ¶æ€ Store (scoreStore)

```typescript
// stores/score.ts
export const useScoreStore = defineStore('score', {
  state: () => ({
    currentScore: 0,
    highScore: loadHighScore(),
    level: 1,
    totalLines: 0
  }),

  actions: {
    addScore(score: number): void
    addLines(lines: number): void
    updateLevel(): void
    resetScore(): void
    saveHighScore(): void
  }
})
```

#### 4.3 UI çŠ¶æ€ Store (uiStore)

```typescript
// stores/ui.ts
export const useUIStore = defineStore('ui', {
  state: () => ({
    showOverlay: true,
    overlayType: 'start',  // 'start' | 'pause' | 'gameover'
    isLoading: false,
    soundEnabled: true      // â­ æ–°å¢
  }),

  actions: {
    showStartOverlay(): void
    showPauseOverlay(): void
    showGameOverOverlay(): void
    hideOverlay(): void
    toggleSound(): void      // â­ æ–°å¢
  }
})
```

---

### 5. æ¸¸æˆé…ç½®ç®¡ç† â­ æ–°å¢

**é›†ä¸­ç®¡ç†æ‰€æœ‰æ¸¸æˆé…ç½®å¸¸é‡**:

```typescript
// config/gameConfig.ts
export const GAME_CONFIG = {
  LEVEL: {
    LINES_PER_LEVEL: 20,
    INITIAL_SPEED: 1000,
    MAX_LEVEL: 20
  },
  SCORE: {
    LINE_1: 100,
    LINE_2: 300,
    LINE_3: 500,
    LINE_4: 800
  },
  BOARD: {
    WIDTH: 10,
    HEIGHT: 20,
    BLOCK_SIZE: 40
  },
  COLORS: {
    I: '#00f0f0',
    O: '#f0f000',
    T: '#a000f0',
    S: '#00f000',
    Z: '#f00000',
    J: '#0000f0',
    L: '#f0a000'
  },
  AUTOSAVE_INTERVAL: 30000  // 30ç§’è‡ªåŠ¨ä¿å­˜
} as const
```

---

### 6. é”™è¯¯å¤„ç†æœºåˆ¶

**é”™è¯¯ç±»å‹å®šä¹‰**:
```typescript
// types/error.ts
export enum GameError {
  INVALID_MOVE = 'invalid_move',           // æ— æ•ˆç§»åŠ¨
  COLLISION_DETECTED = 'collision_detected', // ç¢°æ’æ£€æµ‹
  GAME_OVER = 'game_over',                  // æ¸¸æˆç»“æŸ
  INVALID_ROTATION = 'invalid_rotation',    // æ— æ•ˆæ—‹è½¬
  OUT_OF_BOUNDS = 'out_of_bounds'           // è¶…å‡ºè¾¹ç•Œ
}

export class GameException extends Error {
  constructor(
    public errorType: GameError,
    message: string
  ) {
    super(message)
    this.name = 'GameException'
  }
}
```

**é”™è¯¯å¤„ç†å™¨**:
```typescript
// utils/errorHandler.ts
class ErrorHandler {
  // å¤„ç†æ¸¸æˆé€»è¾‘é”™è¯¯
  handleGameError(error: GameException): void {
    switch (error.errorType) {
      case GameError.GAME_OVER:
        // è§¦å‘æ¸¸æˆç»“æŸ
        break
      case GameError.INVALID_MOVE:
        // å¿½ç•¥æ— æ•ˆç§»åŠ¨
        break
      default:
        console.error(error)
    }
  }

  // å¤„ç† API é”™è¯¯
  handleApiError(error: any): void {
    console.error('API Error:', error)
    // æ˜¾ç¤ºç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º
  }
}
```

---

### 7. API æœåŠ¡ä¸é”™è¯¯é‡è¯• â­ æ”¹è¿›

```typescript
// services/api/gameApi.ts
class GameAPI {
  private readonly BASE_URL = '/api'
  private readonly MAX_RETRIES = 3

  async saveGame(data: GameRecord, retries = this.MAX_RETRIES): Promise<GameRecord> {
    try {
      const response = await fetch(`${this.BASE_URL}/games`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      })

      if (!response.ok) throw new Error('Failed to save game')

      return await response.json()
    } catch (error) {
      if (retries > 0) {
        // å»¶è¿Ÿ1ç§’åé‡è¯•
        await new Promise(resolve => setTimeout(resolve, 1000))
        return this.saveGame(data, retries - 1)
      }

      // å¤±è´¥åä¿å­˜åˆ°æœ¬åœ°
      this.saveToLocalStorage(data)
      throw error
    }
  }

  private saveToLocalStorage(data: GameRecord): void {
    const records = JSON.parse(localStorage.getItem('pending_records') || '[]')
    records.push(data)
    localStorage.setItem('pending_records', JSON.stringify(records))
  }
}
```

---

### 8. Canvas æ¸²æŸ“ä¼˜åŒ– â­ æ”¹è¿›

```typescript
// utils/canvas.ts
class CanvasRenderer {
  private canvas: HTMLCanvasElement
  private ctx: CanvasRenderingContext2D
  private offscreenCanvas: HTMLCanvasElement     // â­ ç¦»å±Canvas
  private offscreenCtx: CanvasRenderingContext2D

  constructor(canvas: HTMLCanvasElement) {
    this.canvas = canvas
    this.ctx = canvas.getContext('2d')!

    // åˆ›å»ºç¦»å±Canvas (åŒç¼“å†²)
    this.offscreenCanvas = document.createElement('canvas')
    this.offscreenCanvas.width = canvas.width
    this.offscreenCanvas.height = canvas.height
    this.offscreenCtx = this.offscreenCanvas.getContext('2d')!
  }

  render(board: Board, piece: Piece): void {
    // 1. åœ¨ç¦»å±Canvasç»˜åˆ¶
    this.drawToOffscreen(board, piece)

    // 2. ä¸€æ¬¡æ€§å¤åˆ¶åˆ°ä¸»Canvas (é¿å…é—ªçƒ)
    this.ctx.drawImage(this.offscreenCanvas, 0, 0)
  }

  private drawToOffscreen(board: Board, piece: Piece): void {
    // æ¸…ç©ºç¦»å±Canvas
    this.offscreenCtx.clearRect(0, 0, this.offscreenCanvas.width, this.offscreenCanvas.height)

    // ç»˜åˆ¶æ£‹ç›˜ã€æ–¹å—ç­‰
    // ...
  }
}
```

---

### 9. å‰ç«¯æ•°æ®æµè½¬

```
ç”¨æˆ·é”®ç›˜è¾“å…¥
    â†“
äº‹ä»¶ç›‘å¬å™¨ (GameCanvas.vue)
    â†“
GameEngine.handleInput()
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PieceManager    â”‚ â† ç§»åŠ¨/æ—‹è½¬æ–¹å— (7-Bag)
â”‚  CollisionDetectorâ”‚ â† æ£€æµ‹ç¢°æ’
â”‚  LineClearManagerâ”‚ â† æ¶ˆé™¤è¡Œ
â”‚  SoundManager    â”‚ â† æ’­æ”¾éŸ³æ•ˆ â­ æ–°å¢
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
æ›´æ–° Board æ•°æ®
    â†“
Pinia Store æ›´æ–°
    â†“
Canvas é‡æ–°æ¸²æŸ“ (åŒç¼“å†²) â­ æ”¹è¿›
    â†“
ç”¨æˆ·çœ‹åˆ°æ¸¸æˆç”»é¢æ›´æ–°
```

---

## ğŸ”§ åç«¯æ¶æ„è®¾è®¡

### 1. åç«¯æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Python | 3.10+ | å¼€å‘è¯­è¨€ |
| FastAPI | 0.104+ | Web æ¡†æ¶ |
| SQLAlchemy | 2.0+ | ORM |
| SQLite | 3.40+ | æ•°æ®åº“ |
| Pydantic | 2.0+ | æ•°æ®éªŒè¯ |
| Pydantic Settings | 2.0+ | é…ç½®ç®¡ç† |
| Uvicorn | 0.24+ | ASGI æœåŠ¡å™¨ |

---

### 2. åç«¯ç›®å½•ç»“æ„

```
elsfk/
â”œâ”€â”€ backend/                         # åç«¯é¡¹ç›®æ ¹ç›®å½•
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ main.py                 # FastAPI åº”ç”¨å…¥å£
â”‚   â”‚   â”œâ”€â”€ config.py               # é…ç½®æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ api/                    # API è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â””â”€â”€ games.py            # æ¸¸æˆè®°å½• API (å«æ’è¡Œæ¦œ)
â”‚   â”‚   â”œâ”€â”€ models/                 # æ•°æ®åº“æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â””â”€â”€ game.py             # æ¸¸æˆè®°å½•æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ schemas/                # Pydantic æ¨¡å¼
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â””â”€â”€ game.py             # æ¸¸æˆè®°å½• DTO
â”‚   â”‚   â”œâ”€â”€ services/               # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â””â”€â”€ game_service.py     # æ¸¸æˆä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ database/               # æ•°æ®åº“ç›¸å…³
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ session.py          # æ•°æ®åº“ä¼šè¯
â”‚   â”‚   â”‚   â”œâ”€â”€ base.py             # åŸºç±»
â”‚   â”‚   â”‚   â””â”€â”€ init_db.py          # æ•°æ®åº“åˆå§‹åŒ– â­ æ–°å¢
â”‚   â”‚   â””â”€â”€ utils/                  # å·¥å…·å‡½æ•°
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ validators.py       # éªŒè¯å·¥å…·
â”‚   â”‚       â””â”€â”€ logger.py           # æ—¥å¿—å·¥å…·
â”‚   â”œâ”€â”€ tests/                      # æµ‹è¯•æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ test_api/
â”‚   â”‚   â””â”€â”€ test_services/
â”‚   â”œâ”€â”€ logs/                       # æ—¥å¿—ç›®å½•
â”‚   â”œâ”€â”€ data.db                     # SQLite æ•°æ®åº“æ–‡ä»¶
â”‚   â”œâ”€â”€ requirements.txt            # Python ä¾èµ–
â”‚   â””â”€â”€ .env                        # ç¯å¢ƒå˜é‡
```

---

### 3. åç«¯æ ¸å¿ƒæ¨¡å—è®¾è®¡

#### 3.1 æ•°æ®åº“æ¨¡å‹

**æ¸¸æˆè®°å½•è¡¨ (games)** - å”¯ä¸€æ•°æ®è¡¨:
```python
# models/game.py
from sqlalchemy import Column, Integer, String, DateTime, Index
from datetime import datetime

class Game(Base):
    __tablename__ = 'games'

    id = Column(Integer, primary_key=True, index=True)
    player_name = Column(String(50), nullable=False)  # ç©å®¶åç§°
    score = Column(Integer, nullable=False)
    level = Column(Integer, nullable=False)
    lines = Column(Integer, nullable=False)
    play_time = Column(Integer, nullable=False)  # æ¸¸æˆæ—¶é•¿(ç§’)
    created_at = Column(DateTime, default=datetime.utcnow, nullable=False)

    # å¤åˆç´¢å¼•ï¼Œä¼˜åŒ–æ’è¡Œæ¦œæŸ¥è¯¢
    __table_args__ = (
        Index('idx_score_created', 'score', 'created_at'),
    )
```

**è¯´æ˜**: æ’è¡Œæ¦œé€šè¿‡æŸ¥è¯¢ games è¡¨è·å–ï¼Œæ— éœ€å•ç‹¬çš„ leaderboard è¡¨ã€‚

---

#### 3.2 API æ¥å£è®¾è®¡

**æ¸¸æˆè®°å½•å’Œæ’è¡Œæ¦œ API**:
```python
# api/games.py
from fastapi import APIRouter, HTTPException
from typing import List

router = APIRouter()

@router.post('/api/games', response_model=GameResponse)
async def save_game(game: GameCreate):
    """ä¿å­˜æ¸¸æˆè®°å½•"""
    pass

@router.get('/api/games', response_model=List[GameResponse])
async def get_games(skip: int = 0, limit: int = 20):
    """è·å–æ¸¸æˆå†å²è®°å½•"""
    pass

@router.get('/api/leaderboard', response_model=List[GameResponse])
async def get_leaderboard(limit: int = 10):
    """è·å–æ’è¡Œæ¦œ Top N (æŒ‰åˆ†æ•°æ’åº)"""
    pass
```

---

#### 3.3 ä¸šåŠ¡é€»è¾‘å±‚

**æ¸¸æˆæœåŠ¡ (GameService)**:
```python
# services/game_service.py
class GameService:
    def save_game_record(self, game_data: GameCreate) -> Game:
        """ä¿å­˜æ¸¸æˆè®°å½•åˆ°æ•°æ®åº“"""
        pass

    def get_game_history(self, skip: int, limit: int) -> List[Game]:
        """è·å–æ¸¸æˆå†å²è®°å½•"""
        pass

    def get_top_scores(self, limit: int) -> List[Game]:
        """è·å–æ’è¡Œæ¦œå‰ N å"""
        # å°±æ˜¯æŸ¥è¯¢ games è¡¨æŒ‰åˆ†æ•°æ’åº
        pass

    def calculate_play_time(self, start_time: datetime) -> int:
        """è®¡ç®—æ¸¸æˆæ—¶é•¿"""
        pass
```

---

#### 3.4 æ•°æ®åº“åˆå§‹åŒ– â­ æ–°å¢

```python
# database/init_db.py
from sqlalchemy import create_engine
from .base import Base
from ..models.game import Game

def init_database(db_url: str):
    """åˆ›å»ºæ•°æ®åº“è¡¨"""
    engine = create_engine(db_url)
    Base.metadata.create_all(bind=engine)
    return engine
```

```python
# main.py
@app.on_event("startup")
async def startup_event():
    """åº”ç”¨å¯åŠ¨æ—¶åˆå§‹åŒ–æ•°æ®åº“"""
    from app.database.init_db import init_database
    from app.config import settings

    init_database(settings.DATABASE_URL)
```

---

#### 3.5 é…ç½®ç®¡ç†

```python
# config.py
from pydantic_settings import BaseSettings

class Settings(BaseSettings):
    # åº”ç”¨é…ç½®
    APP_NAME: str = "Tetris Game"
    DEBUG: bool = True

    # æ•°æ®åº“é…ç½®
    DATABASE_URL: str = "sqlite:///./data.db"

    # CORS é…ç½®
    ALLOWED_ORIGINS: list[str] = ["http://localhost:5173", "http://localhost:3000"]

    # æ¸¸æˆé…ç½®
    LINES_PER_LEVEL: int = 20
    INITIAL_SPEED: int = 1000

    class Config:
        env_file = ".env"

settings = Settings()
```

---

#### 3.6 CORS é…ç½®

```python
# main.py
from fastapi.middleware.cors import CORSMiddleware
from .config import settings

app = FastAPI(title=settings.APP_NAME)

# CORS é…ç½®
app.add_middleware(
    CORSMiddleware,
    allow_origins=settings.ALLOWED_ORIGINS,
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)
```

---

#### 3.7 æ—¥å¿—ç³»ç»Ÿ

```python
# utils/logger.py
import logging
import os
from datetime import datetime

def setup_logger():
    """é…ç½®æ—¥å¿—ç³»ç»Ÿ"""
    # åˆ›å»º logs ç›®å½•
    os.makedirs("logs", exist_ok=True)

    # é…ç½®æ—¥å¿—æ ¼å¼
    logging.basicConfig(
        level=logging.INFO,
        format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
        handlers=[
            logging.FileHandler(f"logs/app_{datetime.now().strftime('%Y%m%d')}.log"),
            logging.StreamHandler()
        ]
    )

    return logging.getLogger(__name__)
```

---

### 4. åç«¯æ•°æ®æµè½¬

```
å‰ç«¯è¯·æ±‚ (HTTP/JSON)
    â†“
FastAPI è·¯ç”±å±‚
    â†“
Pydantic æ•°æ®éªŒè¯
    â†“
ä¸šåŠ¡é€»è¾‘å±‚ (Service)
    â†“
SQLAlchemy ORM
    â†“
SQLite æ•°æ®åº“
    â†“
è¿”å›ç»“æœ (JSON)
```

---

## ğŸ”„ å‰åç«¯äº¤äº’è®¾è®¡

### API æ¥å£è§„èŒƒ

#### 1. ä¿å­˜æ¸¸æˆè®°å½•

**è¯·æ±‚**:
```http
POST /api/games
Content-Type: application/json

{
  "player_name": "Player1",
  "score": 5000,
  "level": 8,
  "lines": 45,
  "play_time": 180
}
```

**å“åº”**:
```json
{
  "id": 1,
  "player_name": "Player1",
  "score": 5000,
  "level": 8,
  "lines": 45,
  "play_time": 180,
  "created_at": "2026-01-20T10:30:00Z"
}
```

#### 2. è·å–æ’è¡Œæ¦œ

**è¯·æ±‚**:
```http
GET /api/leaderboard?limit=10
```

**å“åº”**:
```json
[
  {
    "id": 1,
    "player_name": "Player1",
    "score": 10000,
    "level": 15,
    "lines": 120,
    "play_time": 300,
    "created_at": "2026-01-20T10:30:00Z"
  },
  ...
]
```

---

## ğŸ’¾ æ•°æ®å­˜å‚¨è®¾è®¡

### 1. æµè§ˆå™¨å­˜å‚¨ (localStorage)

**å­˜å‚¨å†…å®¹**:
```typescript
interface LocalStorageData {
  highScore: number           // æœ€é«˜åˆ†
  gamesPlayed: number         // æ¸¸æˆæ¬¡æ•°
  gameProgress?: GameProgress  // æ¸¸æˆè¿›åº¦ â­ æ–°å¢
  pendingRecords: GameRecord[] // å¾…æäº¤è®°å½• â­ æ–°å¢
  settings: {
    soundEnabled: boolean     // éŸ³æ•ˆå¼€å…³
    showKeyHints: boolean     // æ˜¾ç¤ºæŒ‰é”®æç¤º
  }
}
```

**å­˜å‚¨ç­–ç•¥**:
- æœ€é«˜åˆ†: æ°¸ä¹…å­˜å‚¨
- æ¸¸æˆè®¾ç½®: æ°¸ä¹…å­˜å‚¨
- æ¸¸æˆæ¬¡æ•°: æ°¸ä¹…å­˜å‚¨
- æ¸¸æˆè¿›åº¦: è‡ªåŠ¨ä¿å­˜,ç”¨äºæ–­çº¿æ¢å¤ â­ æ–°å¢
- å¾…æäº¤è®°å½•: APIå¤±è´¥æ—¶çš„å¤‡ä»½ â­ æ–°å¢

### 2. SQLite æ•°æ®åº“

**è¡¨ç»“æ„**:

**games è¡¨**:
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | INTEGER | ä¸»é”® |
| player_name | VARCHAR(50) | ç©å®¶åç§° |
| score | INTEGER | åˆ†æ•° |
| level | INTEGER | ç­‰çº§ |
| lines | INTEGER | æ¶ˆé™¤è¡Œæ•° |
| play_time | INTEGER | æ¸¸æˆæ—¶é•¿(ç§’) |
| created_at | DATETIME | åˆ›å»ºæ—¶é—´ |

**ç´¢å¼•**:
- `idx_score_created`: å¤åˆç´¢å¼• (score DESC, created_at DESC) - ä¼˜åŒ–æ’è¡Œæ¦œæŸ¥è¯¢
- `id`: ä¸»é”®ç´¢å¼•

---

## ğŸ¨ TypeScript ç±»å‹å®šä¹‰

### æ¸¸æˆæ ¸å¿ƒç±»å‹

```typescript
// types/game.ts
export enum GameState {
  IDLE = 'idle',
  PLAYING = 'playing',
  PAUSED = 'paused',
  GAMEOVER = 'gameover'
}

export interface Board {
  width: number
  height: number
  grid: Cell[][]
}

export interface Cell {
  occupied: boolean
  color: string | null
}

export interface Position {
  x: number
  y: number
}
```

```typescript
// types/piece.ts
export type PieceType = 'I' | 'O' | 'T' | 'S' | 'Z' | 'J' | 'L'

export interface Piece {
  type: PieceType
  shape: number[][]
  color: string
  position: Position
  rotation: number
}

export const PIECE_SHAPES: Record<PieceType, number[][]> = {
  I: [[1, 1, 1, 1]],
  O: [[1, 1], [1, 1]],
  T: [[0, 1, 0], [1, 1, 1]],
  S: [[0, 1, 1], [1, 1, 0]],
  Z: [[1, 1, 0], [0, 1, 1]],
  J: [[1, 0, 0], [1, 1, 1]],
  L: [[0, 0, 1], [1, 1, 1]]
}

// â­ å®Œæ•´çš„æ—‹è½¬çŠ¶æ€å®šä¹‰
export const PIECE_ROTATIONS: Record<PieceType, number[][][]> = {
  I: [
    [[1, 1, 1, 1]],                    // 0Â°
    [[1], [1], [1], [1]],              // 90Â°
    [[1, 1, 1, 1]],                   // 180Â°
    [[1], [1], [1], [1]]               // 270Â°
  ],
  O: [
    [[1, 1], [1, 1]],                 // 0Â° (æ‰€æœ‰æ–¹å‘ç›¸åŒ)
    [[1, 1], [1, 1]],
    [[1, 1], [1, 1]],
    [[1, 1], [1, 1]]
  ],
  T: [
    [[0, 1, 0], [1, 1, 1]],           // 0Â°
    [[1, 0], [1, 1], [1, 0]],         // 90Â°
    [[1, 1, 1], [0, 1, 0]],           // 180Â°
    [[0, 1], [1, 1], [0, 1]]          // 270Â°
  ],
  S: [
    [[0, 1, 1], [1, 1, 0]],           // 0Â°
    [[1, 0], [1, 1], [0, 1]],         // 90Â°
    [[0, 1, 1], [1, 1, 0]],           // 180Â°
    [[1, 0], [1, 1], [0, 1]]          // 270Â°
  ],
  Z: [
    [[1, 1, 0], [0, 1, 1]],           // 0Â°
    [[0, 1], [1, 1], [1, 0]],         // 90Â°
    [[1, 1, 0], [0, 1, 1]],           // 180Â°
    [[0, 1], [1, 1], [1, 0]]          // 270Â°
  ],
  J: [
    [[1, 0, 0], [1, 1, 1]],           // 0Â°
    [[1, 1], [1, 0], [1, 0]],         // 90Â°
    [[1, 1, 1], [0, 0, 1]],           // 180Â°
    [[0, 1], [0, 1], [1, 1]]          // 270Â°
  ],
  L: [
    [[0, 0, 1], [1, 1, 1]],           // 0Â°
    [[1, 0], [1, 0], [1, 1]],         // 90Â°
    [[1, 1, 1], [1, 0, 0]],           // 180Â°
    [[1, 1], [0, 1], [0, 1]]          // 270Â°
  ]
}

// æ–¹å—é¢œè‰²é…ç½®
export const PIECE_COLORS: Record<PieceType, string> = {
  I: '#00f0f0',
  O: '#f0f000',
  T: '#a000f0',
  S: '#00f000',
  Z: '#f00000',
  J: '#0000f0',
  L: '#f0a000'
}
```

```typescript
// types/api.ts
export interface GameRecord {
  id?: number
  player_name: string
  score: number
  level: number
  lines: number
  play_time: number
  created_at?: string
}

// â­ æ–°å¢: æ¸¸æˆè¿›åº¦ç±»å‹
export interface GameProgress {
  board: Board
  currentPiece: Piece
  nextPiece: Piece
  score: number
  level: number
  lines: number
}
```

```typescript
// types/error.ts
export enum GameError {
  INVALID_MOVE = 'invalid_move',
  COLLISION_DETECTED = 'collision_detected',
  GAME_OVER = 'game_over',
  INVALID_ROTATION = 'invalid_rotation',
  OUT_OF_BOUNDS = 'out_of_bounds'
}

export class GameException extends Error {
  constructor(
    public errorType: GameError,
    message: string
  ) {
    super(message)
    this.name = 'GameException'
  }
}
```

---

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### å‰ç«¯æµ‹è¯•

**æµ‹è¯•å·¥å…·**:
- Vitest: å•å…ƒæµ‹è¯•
- Vue Test Utils: ç»„ä»¶æµ‹è¯•
- Playwright: E2E æµ‹è¯•

**æµ‹è¯•èŒƒå›´**:
```
tests/
â”œâ”€â”€ unit/                    # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ PieceManager.test.ts
â”‚   â”‚   â”œâ”€â”€ CollisionDetector.test.ts
â”‚   â”‚   â”œâ”€â”€ LineClearManager.test.ts
â”‚   â”‚   â””â”€â”€ ScoreManager.test.ts
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ validator.test.ts
â”œâ”€â”€ components/              # ç»„ä»¶æµ‹è¯•
â”‚   â”œâ”€â”€ GameCanvas.test.ts
â”‚   â””â”€â”€ InfoPanel.test.ts
â””â”€â”€ e2e/                     # E2E æµ‹è¯•
    â””â”€â”€ game-flow.spec.ts    # å®Œæ•´æ¸¸æˆæµç¨‹æµ‹è¯•
```

**æµ‹è¯•è¦†ç›–ç‡ç›®æ ‡**: >70%

### åç«¯æµ‹è¯•

**æµ‹è¯•å·¥å…·**: pytest

**æµ‹è¯•èŒƒå›´**:
```
tests/
â”œâ”€â”€ test_api/
â”‚   â””â”€â”€ test_games.py        # API æ¥å£æµ‹è¯•
â””â”€â”€ test_services/
    â””â”€â”€ test_game_service.py # ä¸šåŠ¡é€»è¾‘æµ‹è¯•
```

**æµ‹è¯•è¦†ç›–ç‡ç›®æ ‡**: >70%

---

## ğŸš€ éƒ¨ç½²æ¶æ„

### å¼€å‘ç¯å¢ƒ

```
å‰ç«¯: Vite Dev Server (http://localhost:5173)
åç«¯: Uvicorn (http://localhost:8000)
æ•°æ®åº“: SQLite æ–‡ä»¶ (backend/data.db)
æ—¥å¿—: logs/app.log
```

### ç”Ÿäº§ç¯å¢ƒ

```
å‰ç«¯: é™æ€æ–‡ä»¶æ‰˜ç®¡ (Nginx)
åç«¯: Uvicorn + Gunicorn (åå‘ä»£ç†)
æ•°æ®åº“: SQLite æ–‡ä»¶
æ—¥å¿—: logs/app_YYYYMMDD.log
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### å‰ç«¯ä¼˜åŒ–

1. **Canvas æ¸²æŸ“ä¼˜åŒ–**
   - ä½¿ç”¨ `requestAnimationFrame` æ§åˆ¶å¸§ç‡
   - åŒç¼“å†²æ¸²æŸ“ (ç¦»å±Canvas) â­ æ”¹è¿›
   - åªé‡ç»˜å˜åŒ–çš„åŒºåŸŸ

2. **æ¸¸æˆå¾ªç¯ä¼˜åŒ–**
   - ä½¿ç”¨ deltaTime æ§åˆ¶æ¸¸æˆé€Ÿåº¦
   - åˆ†ç¦»é€»è¾‘æ›´æ–°å’Œæ¸²æŸ“

3. **çŠ¶æ€ç®¡ç†ä¼˜åŒ–**
   - ä½¿ç”¨ Pinia çš„ action è¿›è¡Œæ‰¹é‡æ›´æ–°
   - é¿å…åœ¨ watch ä¸­è¿›è¡Œå¤æ‚è®¡ç®—

### åç«¯ä¼˜åŒ–

1. **æ•°æ®åº“ä¼˜åŒ–**
   - ä¸ºå¸¸ç”¨æŸ¥è¯¢å­—æ®µæ·»åŠ ç´¢å¼•
   - ä½¿ç”¨è¿æ¥æ± ç®¡ç†æ•°æ®åº“è¿æ¥

2. **API ä¼˜åŒ–**
   - å®ç°è¯·æ±‚ç¼“å­˜
   - ä½¿ç”¨å¼‚æ­¥å¤„ç†

---

## ğŸ”’ å®‰å…¨è®¾è®¡

1. **è¾“å…¥éªŒè¯**
   - å‰ç«¯: TypeScript ç±»å‹æ£€æŸ¥
   - åç«¯: Pydantic æ•°æ®éªŒè¯

2. **SQL æ³¨å…¥é˜²æŠ¤**
   - ä½¿ç”¨ SQLAlchemy ORM

3. **CORS é…ç½®**
   - ä»…å…è®¸å‰ç«¯åŸŸåè®¿é—®

4. **æ•°æ®æ¸…ç†**
   - å®šæœŸæ¸…ç†è¿‡æœŸçš„æ¸¸æˆè®°å½•

---

## âœ… æ¶æ„è®¾è®¡åŸåˆ™

1. **å•ä¸€èŒè´£**: æ¯ä¸ªæ¨¡å—åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½
2. **æ¾è€¦åˆ**: æ¨¡å—é—´ä¾èµ–æ¥å£è€Œéå®ç°
3. **é«˜å†…èš**: ç›¸å…³åŠŸèƒ½ç»„ç»‡åœ¨åŒä¸€æ¨¡å—
4. **å¯æ‰©å±•**: æ˜“äºæ·»åŠ æ–°åŠŸèƒ½
5. **å¯æµ‹è¯•**: æ¯ä¸ªæ¨¡å—å¯ç‹¬ç«‹æµ‹è¯•

---

**æ–‡æ¡£ç‰ˆæœ¬**: v4.0
**åˆ›å»ºæ—¥æœŸ**: 2026-01-20
**æœ€åæ›´æ–°**: 2026-01-22
**æ›´æ–°å†…å®¹**:

### v3.0 â†’ v4.0 æ›´æ–°:

**ğŸ”´ æ ¸å¿ƒåŠŸèƒ½å¢å¼º (å·²å®Œæˆ)**:
1. âœ… ç”¨æˆ·åç³»ç»Ÿ (PlayerNameDialog + usePlayerName composable)
2. âœ… ç”¨æˆ·åæŒä¹…åŒ– (localStorage)
3. âœ… æ¸¸æˆè®°å½•å…³è”ç”¨æˆ·å
4. âœ… æ’è¡Œæ¦œæ˜¾ç¤ºç©å®¶åç§°

**ğŸŸ¡ æ¶æ„ä¼˜åŒ– (å·²å®Œæˆ)**:
5. âœ… ç»„ä»¶æ‹†åˆ†ä¼˜åŒ– (GameBoardã€PieceRendererã€GameCanvas)
6. âœ… WebSocketå®æ—¶é€šä¿¡ (æ’è¡Œæ¦œæ›´æ–°)
7. âœ… å…¨å±€å¿«æ·é”®å¤„ç† (ä¸åŒºåˆ†å¤§å°å†™)
8. âœ… ä»£ç åˆ†å‰²ä¼˜åŒ– (manualChunks)

**ğŸŸ¢ ç”¨æˆ·ä½“éªŒæå‡ (å·²å®Œæˆ)**:
9. âœ… å¹½çµæ–¹å—é¢„è§ˆ
10. âœ… è‡ªåŠ¨é‡è¿æœºåˆ¶
11. âœ… å®æ—¶æ’è¡Œæ¦œé€šçŸ¥
11. âœ… localStorage å­˜å‚¨æ‰©å±•
